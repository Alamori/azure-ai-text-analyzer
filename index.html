<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure AI Text Analyzer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; padding: 0; font-family: system-ui, -apple-system, sans-serif; }
        .spinner { border: 3px solid #f3f4f6; border-top: 3px solid #4f46e5; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // Simple vanilla JavaScript implementation
        class AzureAIAnalyzer {
            constructor() {
                this.text = '';
                this.result = '';
                this.loading = false;
                this.error = '';
                this.init();
            }

            init() {
                this.render();
                this.attachEventListeners();
            }

            attachEventListeners() {
                const textarea = document.getElementById('textInput');
                const button = document.getElementById('analyzeBtn');

                textarea.addEventListener('input', (e) => {
                    this.text = e.target.value;
                    this.updateCharCount();
                    this.updateButtonState();
                });

                textarea.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && e.ctrlKey) {
                        this.analyzeText();
                    }
                });

                button.addEventListener('click', () => this.analyzeText());
            }

            updateCharCount() {
                const charCount = document.getElementById('charCount');
                charCount.textContent = `${this.text.length} characters • Press Ctrl+Enter to analyze`;
            }

            updateButtonState() {
                const button = document.getElementById('analyzeBtn');
                button.disabled = this.loading || !this.text.trim();
            }

            async analyzeText() {
                if (!this.text.trim()) {
                    this.showError('Please enter some text to analyze');
                    return;
                }

                this.loading = true;
                this.error = '';
                this.result = '';
                this.updateUI();

                try {
                    const response = await fetch('https://api.anthropic.com/v1/messages', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model: 'claude-sonnet-4-20250514',
                            max_tokens: 500,
                            messages: [{
                                role: 'user',
                                content: `Analyze the following text and provide: 
1. Sentiment (positive/negative/neutral)
2. Key topics
3. Brief summary

Text: "${this.text}"

Respond in a clear, structured format.`
                            }]
                        })
                    });

                    if (!response.ok) {
                        throw new Error('Analysis failed');
                    }

                    const data = await response.json();
                    this.result = data.content[0].text;
                    this.showResult();
                } catch (err) {
                    this.showError('Failed to analyze text. Please try again.');
                } finally {
                    this.loading = false;
                    this.updateUI();
                }
            }

            showError(message) {
                this.error = message;
                const errorDiv = document.getElementById('errorMessage');
                errorDiv.innerHTML = `
                    <div class="mt-4 p-4 bg-red-50 border border-red-200 rounded-lg">
                        <p class="text-red-700 text-sm">${message}</p>
                    </div>
                `;
            }

            showResult() {
                const resultDiv = document.getElementById('resultSection');
                resultDiv.innerHTML = `
                    <div class="mt-6 p-6 bg-gradient-to-r from-indigo-50 to-blue-50 rounded-lg border-2 border-indigo-200">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2">
                            <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
                            </svg>
                            Analysis Results
                        </h3>
                        <div class="prose prose-sm max-w-none">
                            <pre class="whitespace-pre-wrap text-gray-700 font-sans bg-white p-4 rounded-lg">${this.result}</pre>
                        </div>
                    </div>
                `;
            }

            updateUI() {
                const button = document.getElementById('analyzeBtn');
                const buttonContent = document.getElementById('buttonContent');
                
                if (this.loading) {
                    buttonContent.innerHTML = `
                        <div class="spinner"></div>
                        <span>Analyzing...</span>
                    `;
                } else {
                    buttonContent.innerHTML = `
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                        </svg>
                        <span>Analyze Text</span>
                    `;
                }
                
                this.updateButtonState();

                if (!this.error) {
                    document.getElementById('errorMessage').innerHTML = '';
                }
            }

            render() {
                const app = document.getElementById('app');
                app.innerHTML = `
                    <div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
                        <div class="max-w-4xl mx-auto py-8">
                            <!-- Header -->
                            <div class="text-center mb-8">
                                <div class="flex items-center justify-center gap-3 mb-4">
                                    <svg class="w-10 h-10 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
                                    </svg>
                                    <h1 class="text-4xl font-bold text-gray-800">
                                        Azure AI Text Analyzer
                                    </h1>
                                </div>
                                <p class="text-gray-600 text-lg">
                                    Powered by Azure AI - Analyze sentiment, topics, and summaries
                                </p>
                            </div>

                            <!-- Main Card -->
                            <div class="bg-white rounded-2xl shadow-xl p-8">
                                <!-- Input Section -->
                                <div class="mb-6">
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        Enter Text to Analyze
                                    </label>
                                    <textarea
                                        id="textInput"
                                        placeholder="Paste or type your text here... (Press Ctrl+Enter to analyze)"
                                        class="w-full h-40 px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-indigo-500 focus:outline-none resize-none text-gray-700"
                                    ></textarea>
                                    <p class="text-sm text-gray-500 mt-2" id="charCount">
                                        0 characters • Press Ctrl+Enter to analyze
                                    </p>
                                </div>

                                <!-- Analyze Button -->
                                <button
                                    id="analyzeBtn"
                                    class="w-full bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-lg transition-colors flex items-center justify-center gap-2"
                                >
                                    <div id="buttonContent" class="flex items-center justify-center gap-2">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                                        </svg>
                                        <span>Analyze Text</span>
                                    </div>
                                </button>

                                <!-- Error Message -->
                                <div id="errorMessage"></div>

                                <!-- Results Section -->
                                <div id="resultSection"></div>
                            </div>

                            <!-- Footer -->
                            <div class="text-center mt-8 text-sm text-gray-600">
                                <p>Deployed on Azure Static Web Apps • Built with Azure AI</p>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // Initialize the app when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new AzureAIAnalyzer();
        });
    </script>
</body>
</html>